)]}'
{"version":3,"file":"/packages/anti:i18n.js","sources":["anti:i18n/i18n.js"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA,E;AACA,iC;AACA,2C;AACA,E;;;AAGA,yB;AACA,yB;AACA,2B;AACA,yB;AACA,4B;AACA,4C;;;AAGA,E;AACA,0C;AACA,E;AACA,mB;AACA,e;;AAEA,Y;AACA,kC;;AAEA,6C;AACA,+C;AACA,gB;AACA,G;;AAEA,sB;AACA,e;;AAEA,E;AACA,0C;AACA,wD;AACA,mE;AACA,8H;AACA,Y;AACA,oC;AACA,a;AACA,E;;AAEA,E;AACA,4B;AACA,E;AACA,qB;AACA,U;AACA,2C;AACA,yC;AACA,O;AACA,yB;AACA,mD;AACA,yC;AACA,O;AACA,G;AACA,C;;AAEA,4C;AACA,yB;AACA,yC;AACA,wB;AACA,2D;AACA,K;;AAEA,mB;AACA,E;;AAEA,E;AACA,U;AACA,E;AACA,kC;AACA,iB;AACA,gB;AACA,E;;AAEA,yC;AACA,wB;AACA,gB;AACA,E;;AAEA,+B;AACA,e;AACA,kB;AACA,E;;AAEA,uC;AACA,gB;AACA,sC;AACA,iC;AACA,Y;AACA,yC;AACA,K;AACA,uB;AACA,U;AACA,yB;AACA,wB;AACA,G;AACA,E;;AAEA,E;AACA,c;AACA,E;AACA,oC;AACA,0C;AACA,wC;AACA,gB;AACA,E;;AAEA,wD;AACA,+B;AACA,iC;AACA,sC;AACA,kC;AACA,sC;AACA,uD;AACA,O;AACA,G;AACA,E","sourcesContent":["/*\n  just-i18n package for Meteor.js\n  author: Hubert OG <hubert@orlikarnia.com>\n*/\n\n\nvar maps            = {};\nvar language        = '';\nvar defaultLanguage = 'en';\nvar missingTemplate = '';\nvar showMissing     = false;\nvar dep             = new Deps.Dependency();\n\n\n/*\n  Convert key to internationalized version\n*/\ni18n = function() {\n  dep.depend();\n\n  var label;\n  var args = _.toArray(arguments);\n\n  /* remove extra parameter added by blaze */\n  if(typeof args[args.length-1] === 'object') {\n    args.pop(); \n  }\n\n  var label = args[0];\n  args.shift();\n\n  \n  if(typeof label !== 'string') return '';\n  var str = (maps[language] && maps[language][label]) ||\n         (maps[defaultLanguage] && maps[defaultLanguage][label]) ||\n         (showMissing && _.template(missingTemplate, {language: language, defaultLanguage: defaultLanguage, label: label})) ||\n         '';\n  str = replaceWithParams(str, args)\n  return str;\n};\n\n/*\n  Register handlebars helper\n*/\nif(Meteor.isClient) {\n  if(UI) {\n    UI.registerHelper('i18n', function () {\n      return i18n.apply(this, arguments);\n    });\n  } else if(Handlebars) {\n    Handlebars.registerHelper('i18n', function () {\n      return i18n.apply(this, arguments);\n    });\n  }\n}\n\nfunction replaceWithParams(string, params) {\n  var formatted = string;\n  params.forEach(function(param , index){\n    var pos = index + 1;\n    formatted = formatted.replace(\"{$\" + pos + \"}\", param);\n  });\n\n  return formatted;\n};\n\n/*\n  Settings\n*/\ni18n.setLanguage = function(lng) {\n  language = lng;\n  dep.changed();\n};\n\ni18n.setDefaultLanguage = function(lng) {\n  defaultLanguage = lng;\n  dep.changed();\n};\n\ni18n.getLanguage = function() {\n  dep.depend();\n  return language;\n};\n\ni18n.showMissing = function(template) {\n  if(template) {\n    if(typeof template === 'string') {\n      missingTemplate = template;\n    } else {\n      missingTemplate = '[<%= label %>]';\n    }\n    showMissing = true;\n  } else {\n    missingTemplate = '';\n    showMissing = false;\n  }\n};\n\n/*\n  Register map\n*/\ni18n.map = function(language, map) {\n  if(!maps[language]) maps[language] = {};\n  registerMap(language, '', false, map);\n  dep.changed();\n};\n\nvar registerMap = function(language, prefix, dot, map) {\n  if(typeof map === 'string') {\n    maps[language][prefix] = map;\n  } else if(typeof map === 'object') {\n    if(dot) prefix = prefix + '.';\n    _.each(map, function(value, key) {\n      registerMap(language, prefix + key, true, value);\n    });\n  }\n};\n\n"]}